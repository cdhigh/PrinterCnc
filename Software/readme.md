#PIC16F628A雕刻机控制板的上位机

##特性
    * 直接支持大部分软件输出的gerber文件格式，包括Eagle，Sprint-layout等。
    * 不需要像我参考的themrleon项目，画PCB时可以直接输出gerber，而不需要导出图像然后再导入。
    * 支持常用的gerber绘图命令。
    * 将斜线，圆，焊盘等绘图对象转换成控制板能接受的命令。
    * 支持仅使用一种画笔就能画出各种尺寸的直线。
    * 支持gerber文件中有负数坐标，上位机会进行适当运算消除负数。
    

##使用方法
###使用源码文件
    正确安装Python和pyserial后就可以执行CncController.py，这样不限平台。

###使用cxFreeze预编译文件
    当前仅提供windows执行文件

##软件界面说明
    * 串口超时时间指发送命令到控制板直到PC收到答复之间的时间。
    * XYZ轴的速度实际上指的是步进电机脉冲之间的延时时间，所以时间越短运行越快。但是步进电机如果启动频率过高的话，会出现啸叫情况，并且有可能会丢步或过冲。
    * 因为Python的列表框（用于显示收发数据）频繁更新时效率比较低，特别是数据量大时，如果你设定“需要保留条目”太多的话，会导致界面刷新速度比较慢，进而影响打印输出速度，除非需要调试，否则不建议设置大的“需要保留条目”。

##配置文件说明
    * 软件使用ini配置文件保存配置。
    * zLiftSteps：1-255的正整数，在绘图时Z轴升起或下降的步数，数值越大升起后移动越不容易碰到纸张，数值越小绘图速度越快。
    * MinimumX, MinimumY：要求为正的浮点数，单位为微米，为了支持负数坐标而需要的两个参数，一旦存在小于此值的坐标，则所有坐标都加上一个适当的数值，以便所有的坐标都大于此两个设定值。
    * ShiftX, ShiftY：浮点数，可正可负，单位为微米，有些设计软件输出的GERBER文件的生成图案离坐标原点太远，导致雕刻机行程不够或不方便处理，则可以提供这两个数值做为平移图案使用，所有X坐标都加上ShiftX，所有Y坐标都加上ShiftY。
    * 如果同时设置了ShiftX/ShiftY和MinimumX/MinimumY，则软件是先平移整个图案，然后再适当处理确保图案坐标满足MinimumX/MinimumY要求。所以如果ShiftX/ShiftY设置为一个适当的负数，然后MinimumX/MinimumY设置为0.0，则可以将任意图案移动至原点。但是不建议这样做，MinimumX/MinimumY最好大于排版中所用到的最大线宽的一半，避免画线时越界。

##当前支持所有或不支持的Gerber特性和要求：
    *（因精力有限，我选择实现大部分常用特性，而忽略一些不常用或在我这个项目中用不到的RS274X规范，其实大部分的电路板排版都能支持，不用太过担心）
    * 每个绘图行X...Y...Z..必须单独成行，每个绘图行的X/Y/Z都不能省略，不能前缀有G命令和D命令。
    * 焊盘不支持外圆内方，不支持椭圆内部开孔。
    * 仅支持直线插补模式G01，不支持圆弧插补G02/G03。
    * 不支持黑白反相，不支持阴影上色。
    * 不支持G36/G37区域模式。
    * 不支持增量坐标方式，仅支持绝对坐标方式。
    * 不支持aperture宏。
    * 画线仅支持实线，不支持虚线和点划线。

##控制板模拟器说明
    * 此上位机软件自带一个非常简单的模拟器，接受上位机发送的绘图命令，按照实际雕刻机一样的处理绘出图案，可以在实际输出至雕刻机之前看看最后的效果，如果效果不满意则不需要浪费时间真正输出到控制板。
    * 如果要使用模拟器，请点击“打开模拟器”按钮，则打开另一个窗口，不要关闭此窗口，直接切换回来后可以按照正常的步骤一样的操作，之后所有将要发送到控制板的命令都会直接转发至模拟器，而不会再通过串口发送至控制板，模拟器接收到绘图命令后会在其界面上汇出图案（如果图案比较复杂，则比较慢，请耐心等候），如果图案比较小以致看不清楚或太大以致越界，则可以调整模拟器界面上的“X/Y宽度(mm)”值，请点击“全部清除”，然后重新启动绘图命令即可。
    * 因为控制板性能和特性所限，上位机使用海量的水平线和垂直线组成所需要的任何图案，如果输出至模拟器时，因为绘图对象太多，所以速度会很慢，会有一段时间的界面“未响应”，稍等候即可，根据图案的大小和复杂程度，绘图时间可能从几秒到几十秒甚至更长，特别是焊盘比较多的情况。
    * 在不需要模拟器功能时，可以简单的将模拟器界面关闭，则接下来的命令都会直接通过串口发送至真实控制板。

##Sprint-layout注意事项：
    * Sprint-layout使用左下角做为坐标原点，因此，在排版完成后建议适当调整电路板的宽度和高度，让图形尽量靠近左下角，这样输出的gerber文件更适合雕刻机使用（图案不会离设定的原点太远）。
